{{/*
Secrets are managed outside of Helm via OpenBao.
Use scripts/create-secrets-from-openbao.sh to create them before deploying.

This template is kept for reference but disabled by default.
To enable Helm-managed secrets, set: createSecrets.enabled=true
*/}}

{{- if .Values.createSecrets.enabled }}
{{- if .Values.createSecrets.database }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.global.database.secretName }}
  namespace: {{ .Values.global.namespace }}
  labels:
    {{- include "eleduck-analytics.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{ .Values.global.database.secretUserKey }}: {{ .Values.createSecrets.database.username | quote }}
  {{ .Values.global.database.secretPasswordKey }}: {{ .Values.createSecrets.database.password | quote }}
{{- end }}

{{- if .Values.createSecrets.motherduck }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.global.motherduck.secretName }}
  namespace: {{ .Values.global.namespace }}
  labels:
    {{- include "eleduck-analytics.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{ .Values.global.motherduck.secretTokenKey }}: {{ .Values.createSecrets.motherduck.token | quote }}
{{- end }}

{{- if .Values.createSecrets.podcastScraper }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ index .Values "podcast-scraper" "credentialsSecretName" }}
  namespace: {{ .Values.global.namespace }}
  labels:
    {{- include "eleduck-analytics.labels" . | nindent 4 }}
type: Opaque
stringData:
  apple_email: {{ .Values.createSecrets.podcastScraper.apple_email | quote }}
  apple_password: {{ .Values.createSecrets.podcastScraper.apple_password | quote }}
  spotify_sp_cookie: {{ .Values.createSecrets.podcastScraper.spotify_sp_cookie | quote }}
  spotify_sp_key_cookie: {{ .Values.createSecrets.podcastScraper.spotify_sp_key_cookie | quote }}
  amazon_session_cookie: {{ .Values.createSecrets.podcastScraper.amazon_session_cookie | quote }}
  youtube_api_key: {{ .Values.createSecrets.podcastScraper.youtube_api_key | quote }}
  youtube_access_token: {{ .Values.createSecrets.podcastScraper.youtube_access_token | quote }}
{{- end }}
{{- end }}
